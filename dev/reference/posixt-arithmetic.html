<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Arithmetic: date-time — posixt-arithmetic • clock</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Arithmetic: date-time — posixt-arithmetic"><meta name="description" content="These are POSIXct/POSIXlt methods for the
arithmetic generics.
Calendrical based arithmetic:
These functions convert to a naive-time, then to a year-month-day, perform
the arithmetic, then convert back to a date-time.
add_years()
add_quarters()
add_months()


Naive-time based arithmetic:
These functions convert to a naive-time, perform the arithmetic, then
convert back to a date-time.
add_weeks()
add_days()


Sys-time based arithmetic:
These functions convert to a sys-time, perform the arithmetic, then
convert back to a date-time.
add_hours()
add_minutes()
add_seconds()

"><meta property="og:description" content="These are POSIXct/POSIXlt methods for the
arithmetic generics.
Calendrical based arithmetic:
These functions convert to a naive-time, then to a year-month-day, perform
the arithmetic, then convert back to a date-time.
add_years()
add_quarters()
add_months()


Naive-time based arithmetic:
These functions convert to a naive-time, perform the arithmetic, then
convert back to a date-time.
add_weeks()
add_days()


Sys-time based arithmetic:
These functions convert to a sys-time, perform the arithmetic, then
convert back to a date-time.
add_hours()
add_minutes()
add_seconds()

"><meta property="og:image" content="https://clock.r-lib.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="clock.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clock</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/clock.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/motivations.html">Motivations for clock</a></li>
    <li><a class="dropdown-item" href="../articles/recipes.html">Examples and Recipes</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/03/clock-0-1-0/">Version 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/clock/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Arithmetic: date-time</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/clock/blob/main/R/posixt.R" class="external-link"><code>R/posixt.R</code></a></small>
      <div class="d-none name"><code>posixt-arithmetic.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These are POSIXct/POSIXlt methods for the
<a href="clock-arithmetic.html">arithmetic generics</a>.</p>
<p>Calendrical based arithmetic:</p>
<p>These functions convert to a naive-time, then to a year-month-day, perform
the arithmetic, then convert back to a date-time.</p><ul><li><p><code><a href="clock-arithmetic.html">add_years()</a></code></p></li>
<li><p><code><a href="clock-arithmetic.html">add_quarters()</a></code></p></li>
<li><p><code><a href="clock-arithmetic.html">add_months()</a></code></p></li>
</ul><p>Naive-time based arithmetic:</p>
<p>These functions convert to a naive-time, perform the arithmetic, then
convert back to a date-time.</p><ul><li><p><code><a href="clock-arithmetic.html">add_weeks()</a></code></p></li>
<li><p><code><a href="clock-arithmetic.html">add_days()</a></code></p></li>
</ul><p>Sys-time based arithmetic:</p>
<p>These functions convert to a sys-time, perform the arithmetic, then
convert back to a date-time.</p><ul><li><p><code><a href="clock-arithmetic.html">add_hours()</a></code></p></li>
<li><p><code><a href="clock-arithmetic.html">add_minutes()</a></code></p></li>
<li><p><code><a href="clock-arithmetic.html">add_seconds()</a></code></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_years</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span>, invalid <span class="op">=</span> <span class="cn">NULL</span>, nonexistent <span class="op">=</span> <span class="cn">NULL</span>, ambiguous <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_quarters</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span>, invalid <span class="op">=</span> <span class="cn">NULL</span>, nonexistent <span class="op">=</span> <span class="cn">NULL</span>, ambiguous <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_months</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span>, invalid <span class="op">=</span> <span class="cn">NULL</span>, nonexistent <span class="op">=</span> <span class="cn">NULL</span>, ambiguous <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_weeks</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span>, nonexistent <span class="op">=</span> <span class="cn">NULL</span>, ambiguous <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_days</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span>, nonexistent <span class="op">=</span> <span class="cn">NULL</span>, ambiguous <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_hours</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_minutes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="clock-arithmetic.html">add_seconds</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>[POSIXct / POSIXlt]</code></p>
<p>A date-time vector.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p><code>[integer / clock_duration]</code></p>
<p>An integer vector to be converted to a duration, or a duration
corresponding to the arithmetic function being used. This corresponds
to the number of duration units to add. <code>n</code> may be negative to subtract
units of duration.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt id="arg-invalid">invalid<a class="anchor" aria-label="anchor" href="#arg-invalid"></a></dt>
<dd><p><code>[character(1) / NULL]</code></p>
<p>One of the following invalid date resolution strategies:</p><ul><li><p><code>"previous"</code>: The previous valid instant in time.</p></li>
<li><p><code>"previous-day"</code>: The previous valid day in time, keeping the time of
day.</p></li>
<li><p><code>"next"</code>: The next valid instant in time.</p></li>
<li><p><code>"next-day"</code>: The next valid day in time, keeping the time of day.</p></li>
<li><p><code>"overflow"</code>: Overflow by the number of days that the input is invalid
by. Time of day is dropped.</p></li>
<li><p><code>"overflow-day"</code>: Overflow by the number of days that the input is
invalid by. Time of day is kept.</p></li>
<li><p><code>"NA"</code>: Replace invalid dates with <code>NA</code>.</p></li>
<li><p><code>"error"</code>: Error on invalid dates.</p></li>
</ul><p>Using either <code>"previous"</code> or <code>"next"</code> is generally recommended, as these
two strategies maintain the <em>relative ordering</em> between elements of the
input.</p>
<p>If <code>NULL</code>, defaults to <code>"error"</code>.</p>
<p>If <code>getOption("clock.strict")</code> is <code>TRUE</code>, <code>invalid</code> must be supplied and
cannot be <code>NULL</code>. This is a convenient way to make production code robust
to invalid dates.</p></dd>


<dt id="arg-nonexistent">nonexistent<a class="anchor" aria-label="anchor" href="#arg-nonexistent"></a></dt>
<dd><p><code>[character / NULL]</code></p>
<p>One of the following nonexistent time resolution strategies, allowed to be
either length 1, or the same length as the input:</p><ul><li><p><code>"roll-forward"</code>: The next valid instant in time.</p></li>
<li><p><code>"roll-backward"</code>: The previous valid instant in time.</p></li>
<li><p><code>"shift-forward"</code>: Shift the nonexistent time forward by the size of
the daylight saving time gap.</p></li>
<li><p><code>"shift-backward</code>: Shift the nonexistent time backward by the size of
the daylight saving time gap.</p></li>
<li><p><code>"NA"</code>: Replace nonexistent times with <code>NA</code>.</p></li>
<li><p><code>"error"</code>: Error on nonexistent times.</p></li>
</ul><p>Using either <code>"roll-forward"</code> or <code>"roll-backward"</code> is generally
recommended over shifting, as these two strategies maintain the
<em>relative ordering</em> between elements of the input.</p>
<p>If <code>NULL</code>, defaults to <code>"error"</code>.</p>
<p>If <code>getOption("clock.strict")</code> is <code>TRUE</code>, <code>nonexistent</code> must be supplied
and cannot be <code>NULL</code>. This is a convenient way to make production code
robust to nonexistent times.</p></dd>


<dt id="arg-ambiguous">ambiguous<a class="anchor" aria-label="anchor" href="#arg-ambiguous"></a></dt>
<dd><p><code>[character / zoned_time / POSIXct / list(2) / NULL]</code></p>
<p>One of the following ambiguous time resolution strategies, allowed to be
either length 1, or the same length as the input:</p><ul><li><p><code>"earliest"</code>: Of the two possible times, choose the earliest one.</p></li>
<li><p><code>"latest"</code>: Of the two possible times, choose the latest one.</p></li>
<li><p><code>"NA"</code>: Replace ambiguous times with <code>NA</code>.</p></li>
<li><p><code>"error"</code>: Error on ambiguous times.</p></li>
</ul><p>Alternatively, <code>ambiguous</code> is allowed to be a zoned_time (or POSIXct) that
is either length 1, or the same length as the input. If an ambiguous time
is encountered, the zoned_time is consulted. If the zoned_time corresponds
to a naive_time that is also ambiguous <em>and</em> uses the same daylight saving
time transition point as the original ambiguous time, then the offset of
the zoned_time is used to resolve the ambiguity. If the ambiguity cannot be
resolved by consulting the zoned_time, then this method falls back to
<code>NULL</code>.</p>
<p>Finally, <code>ambiguous</code> is allowed to be a list of size 2, where the first
element of the list is a zoned_time (as described above), and the second
element of the list is an ambiguous time resolution strategy to use when
the ambiguous time cannot be resolved by consulting the zoned_time.
Specifying a zoned_time on its own is identical to <code>list(&lt;zoned_time&gt;, NULL)</code>.</p>
<p>If <code>NULL</code>, defaults to <code>"error"</code>.</p>
<p>If <code>getOption("clock.strict")</code> is <code>TRUE</code>, <code>ambiguous</code> must be supplied and
cannot be <code>NULL</code>. Additionally, <code>ambiguous</code> cannot be specified as a
zoned_time on its own, as this implies <code>NULL</code> for ambiguous times that the
zoned_time cannot resolve. Instead, it must be specified as a list
alongside an ambiguous time resolution strategy as described above. This is
a convenient way to make production code robust to ambiguous times.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>x</code> after performing the arithmetic.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Adding a single quarter with <code><a href="clock-arithmetic.html">add_quarters()</a></code> is equivalent to adding
3 months.</p>
<p><code>x</code> and <code>n</code> are recycled against each other using
<a href="https://vctrs.r-lib.org/reference/theory-faq-recycling.html" class="external-link">tidyverse recycling rules</a>.</p>
<p>Calendrical based arithmetic has the potential to generate invalid dates
(like the 31st of February), nonexistent times (due to daylight saving
time gaps), and ambiguous times (due to daylight saving time fallbacks).</p>
<p>Naive-time based arithmetic will never generate an invalid date, but
may generate a nonexistent or ambiguous time (i.e. you added 1 day and
landed in a daylight saving time gap).</p>
<p>Sys-time based arithmetic operates in the UTC time zone, which means
that it will never generate any invalid dates or nonexistent / ambiguous
times.</p>
<p>The conversion from POSIXct/POSIXlt to the corresponding clock type uses
a "best guess" about whether you want to do the arithmetic using a naive-time
or a sys-time. For example, when adding months, you probably want to
retain the printed time when converting to a year-month-day to perform
the arithmetic, so the conversion goes through naive-time. However,
when adding smaller units like seconds, you probably want
<code>"2020-03-08 01:59:59" + 1 second</code> in the America/New_York time zone to
return <code>"2020-03-08 03:00:00"</code>, taking into account the fact that there
was a daylight saving time gap. This requires doing the arithmetic in
sys-time, so that is what clock converts to. If you disagree with this
heuristic for any reason, you can take control and perform the conversions
yourself. For example, you could convert the previous example to a
naive-time instead of a sys-time manually with <code><a href="as_naive_time.html">as_naive_time()</a></code>, add
1 second giving <code>"2020-03-08 02:00:00"</code>, then convert back to a
POSIXct/POSIXlt, dealing with the nonexistent time that gets created by
using the <code>nonexistent</code> argument of <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="relative-ordering">Relative ordering<a class="anchor" aria-label="anchor" href="#relative-ordering"></a></h2>



<p>For the most part, adding time based units to date-times will retain the
relative ordering of the input. For example, if <code>x[1] &lt; x[2]</code> before the
<code>add_*()</code> call, then it is generally also true of the result. Using
<code>invalid = "previous" / "next"</code> and
<code>nonexistent = "roll-forward" / "roll-backward"</code> ensures that this holds
when invalid and nonexistent issues are encountered.</p>
<p>That said, with date-times there is an edge case related to ambiguous times
where the relative ordering could change. Consider these three date-times:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/date_time_build.html">date_time_build</a></span><span class="op">(</span><span class="fl">2012</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">30</span>, zone <span class="op">=</span> <span class="st">"Australia/Melbourne"</span>, ambiguous <span class="op">=</span> <span class="st">"earliest"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/date_time_build.html">date_time_build</a></span><span class="op">(</span><span class="fl">2012</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">00</span>, zone <span class="op">=</span> <span class="st">"Australia/Melbourne"</span>, ambiguous <span class="op">=</span> <span class="st">"latest"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/date_time_build.html">date_time_build</a></span><span class="op">(</span><span class="fl">2012</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">30</span>, zone <span class="op">=</span> <span class="st">"Australia/Melbourne"</span>, ambiguous <span class="op">=</span> <span class="st">"latest"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; [1] "2012-04-01 02:30:00 AEDT" "2012-04-01 02:00:00 AEST"</span></span>
<span><span class="co">#&gt; [3] "2012-04-01 02:30:00 AEST"</span></span></code></pre><p></p></div>
<p>In this case, there was a daylight saving time fallback on <code>2012-04-01</code>
where the clocks went from <code>02:59:59 AEDT -&gt; 02:00:00 AEST</code>. So the times
above are precisely 30 minutes apart, and they are in increasing order.</p>
<p>If we add sys-time based units like hours, minutes, or seconds, then the
relative ordering of these date-times will be preserved. However, arithmetic
that goes through naive-time, like adding days or months, won't preserve
the ordering here:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/clock-arithmetic.html">add_days</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2012-04-02 02:30:00 AEST" "2012-04-02 02:00:00 AEST"</span></span>
<span><span class="co">#&gt; [3] "2012-04-02 02:30:00 AEST"</span></span>
<span><span class="fu"><a href="../reference/clock-arithmetic.html">add_months</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2012-05-01 02:30:00 AEST" "2012-05-01 02:00:00 AEST"</span></span>
<span><span class="co">#&gt; [3] "2012-05-01 02:30:00 AEST"</span></span></code></pre><p></p></div>
<p>Note that the 1st and 3rd values of the result are the same, and the 1st
value is no longer before the 2nd value.</p>
<p>Adding larger units of time in naive-time generally does make more sense
than adding it in sys-time, but it does come with this one edge case to be
aware of when working with date-times (this does not affect dates). If this
has the potential to be an issue, consider only adding sys-time based units
(hours, minutes, and seconds) which can't have these issues.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2019-01-01"</span>, tz <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="clock-arithmetic.html">add_years</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-01-01 EST" "2021-01-01 EST" "2022-01-01 EST" "2023-01-01 EST"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "2024-01-01 EST"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2019-01-31 00:30:00"</span>, tz <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adding 1 month to `y` generates an invalid date. Unlike year-month-day</span></span></span>
<span class="r-in"><span><span class="co"># types, R's native date-time types cannot handle invalid dates, so you must</span></span></span>
<span class="r-in"><span><span class="co"># resolve them immediately. If you don't you get an error:</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="clock-arithmetic.html">add_months</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in invalid_resolve(x, invalid = invalid) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Invalid date found at location 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> Resolve invalid date issues by specifying the `invalid` argument.</span>
<span class="r-in"><span><span class="fu"><a href="clock-arithmetic.html">add_months</a></span><span class="op">(</span><span class="fu"><a href="as_year_month_day.html">as_year_month_day</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;year_month_day&lt;second&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-02-31T00:30:00" "2019-03-31T00:30:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Resolve invalid dates by specifying an invalid date resolution strategy</span></span></span>
<span class="r-in"><span><span class="co"># with the `invalid` argument. Using `"previous"` here sets the date-time to</span></span></span>
<span class="r-in"><span><span class="co"># the previous valid moment in time - i.e. the end of the month. The</span></span></span>
<span class="r-in"><span><span class="co"># time is set to the last moment in the day to retain the relative ordering</span></span></span>
<span class="r-in"><span><span class="co"># within your input. If you are okay with potentially losing this, and</span></span></span>
<span class="r-in"><span><span class="co"># want to retain your time of day, you can use `"previous-day"` to set the</span></span></span>
<span class="r-in"><span><span class="co"># date-time to the previous valid day, while keeping the time of day.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="clock-arithmetic.html">add_months</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, invalid <span class="op">=</span> <span class="st">"previous"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-02-28 23:59:59 EST" "2019-03-31 00:30:00 EDT"</span>
<span class="r-in"><span><span class="fu"><a href="clock-arithmetic.html">add_months</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, invalid <span class="op">=</span> <span class="st">"previous-day"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-02-28 00:30:00 EST" "2019-03-31 00:30:00 EDT"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

