<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert to a zoned-time from a naive-time — as-zoned-time-naive-time • clock</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert to a zoned-time from a naive-time — as-zoned-time-naive-time"><meta name="description" content="This is a naive-time method for the as_zoned_time() generic.
Converting to a zoned-time from a naive-time retains the printed time,
but changes the underlying duration, depending on the zone that you choose.
Naive-times are time points with a yet-to-be-determined time zone. By
converting them to a zoned-time, all you are doing is specifying that
time zone while attempting to keep all other printed information the
same (if possible).
If you want to retain the underlying duration, try converting to a zoned-time
from a sys-time, which is a time point
interpreted as having a UTC time zone."><meta property="og:description" content="This is a naive-time method for the as_zoned_time() generic.
Converting to a zoned-time from a naive-time retains the printed time,
but changes the underlying duration, depending on the zone that you choose.
Naive-times are time points with a yet-to-be-determined time zone. By
converting them to a zoned-time, all you are doing is specifying that
time zone while attempting to keep all other printed information the
same (if possible).
If you want to retain the underlying duration, try converting to a zoned-time
from a sys-time, which is a time point
interpreted as having a UTC time zone."><meta property="og:image" content="https://clock.r-lib.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="clock.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clock</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/clock.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/motivations.html">Motivations for clock</a></li>
    <li><a class="dropdown-item" href="../articles/recipes.html">Examples and Recipes</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/03/clock-0-1-0/">Version 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/clock/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Convert to a zoned-time from a naive-time</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/clock/blob/main/R/naive-time.R" class="external-link"><code>R/naive-time.R</code></a></small>
      <div class="d-none name"><code>as-zoned-time-naive-time.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a naive-time method for the <code><a href="as_zoned_time.html">as_zoned_time()</a></code> generic.</p>
<p>Converting to a zoned-time from a naive-time retains the printed time,
but changes the underlying duration, depending on the <code>zone</code> that you choose.</p>
<p>Naive-times are time points with a yet-to-be-determined time zone. By
converting them to a zoned-time, all you are doing is specifying that
time zone while attempting to keep all other printed information the
same (if possible).</p>
<p>If you want to retain the underlying duration, try converting to a zoned-time
<a href="as-zoned-time-sys-time.html">from a sys-time</a>, which is a time point
interpreted as having a UTC time zone.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'clock_naive_time'</span></span>
<span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">zone</span>, <span class="va">...</span>, nonexistent <span class="op">=</span> <span class="cn">NULL</span>, ambiguous <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>[clock_naive_time]</code></p>
<p>A naive-time to convert to a zoned-time.</p></dd>


<dt id="arg-zone">zone<a class="anchor" aria-label="anchor" href="#arg-zone"></a></dt>
<dd><p><code>[character(1)]</code></p>
<p>The zone to convert to.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt id="arg-nonexistent">nonexistent<a class="anchor" aria-label="anchor" href="#arg-nonexistent"></a></dt>
<dd><p><code>[character / NULL]</code></p>
<p>One of the following nonexistent time resolution strategies, allowed to be
either length 1, or the same length as the input:</p><ul><li><p><code>"roll-forward"</code>: The next valid instant in time.</p></li>
<li><p><code>"roll-backward"</code>: The previous valid instant in time.</p></li>
<li><p><code>"shift-forward"</code>: Shift the nonexistent time forward by the size of
the daylight saving time gap.</p></li>
<li><p><code>"shift-backward</code>: Shift the nonexistent time backward by the size of
the daylight saving time gap.</p></li>
<li><p><code>"NA"</code>: Replace nonexistent times with <code>NA</code>.</p></li>
<li><p><code>"error"</code>: Error on nonexistent times.</p></li>
</ul><p>Using either <code>"roll-forward"</code> or <code>"roll-backward"</code> is generally
recommended over shifting, as these two strategies maintain the
<em>relative ordering</em> between elements of the input.</p>
<p>If <code>NULL</code>, defaults to <code>"error"</code>.</p>
<p>If <code>getOption("clock.strict")</code> is <code>TRUE</code>, <code>nonexistent</code> must be supplied
and cannot be <code>NULL</code>. This is a convenient way to make production code
robust to nonexistent times.</p></dd>


<dt id="arg-ambiguous">ambiguous<a class="anchor" aria-label="anchor" href="#arg-ambiguous"></a></dt>
<dd><p><code>[character / zoned_time / POSIXct / list(2) / NULL]</code></p>
<p>One of the following ambiguous time resolution strategies, allowed to be
either length 1, or the same length as the input:</p><ul><li><p><code>"earliest"</code>: Of the two possible times, choose the earliest one.</p></li>
<li><p><code>"latest"</code>: Of the two possible times, choose the latest one.</p></li>
<li><p><code>"NA"</code>: Replace ambiguous times with <code>NA</code>.</p></li>
<li><p><code>"error"</code>: Error on ambiguous times.</p></li>
</ul><p>Alternatively, <code>ambiguous</code> is allowed to be a zoned_time (or POSIXct) that
is either length 1, or the same length as the input. If an ambiguous time
is encountered, the zoned_time is consulted. If the zoned_time corresponds
to a naive_time that is also ambiguous <em>and</em> uses the same daylight saving
time transition point as the original ambiguous time, then the offset of
the zoned_time is used to resolve the ambiguity. If the ambiguity cannot be
resolved by consulting the zoned_time, then this method falls back to
<code>NULL</code>.</p>
<p>Finally, <code>ambiguous</code> is allowed to be a list of size 2, where the first
element of the list is a zoned_time (as described above), and the second
element of the list is an ambiguous time resolution strategy to use when
the ambiguous time cannot be resolved by consulting the zoned_time.
Specifying a zoned_time on its own is identical to <code>list(&lt;zoned_time&gt;, NULL)</code>.</p>
<p>If <code>NULL</code>, defaults to <code>"error"</code>.</p>
<p>If <code>getOption("clock.strict")</code> is <code>TRUE</code>, <code>ambiguous</code> must be supplied and
cannot be <code>NULL</code>. Additionally, <code>ambiguous</code> cannot be specified as a
zoned_time on its own, as this implies <code>NULL</code> for ambiguous times that the
zoned_time cannot resolve. Instead, it must be specified as a list
alongside an ambiguous time resolution strategy as described above. This is
a convenient way to make production code robust to ambiguous times.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A zoned-time vector.</p>
    </div>
    <div class="section level2">
    <h2 id="daylight-saving-time">Daylight Saving Time<a class="anchor" aria-label="anchor" href="#daylight-saving-time"></a></h2>



<p>Converting from a naive-time to a zoned-time is not always possible due to
daylight saving time issues. There are two types of these issues:</p>
<p><em>Nonexistent</em> times are the result of daylight saving time "gaps".
For example, in the America/New_York time zone, there was a daylight
saving time gap 1 second after <code>"2020-03-08 01:59:59"</code>, where the clocks
changed from <code>01:59:59 -&gt; 03:00:00</code>, completely skipping the 2 o'clock hour.
This means that if you had a naive time of <code>"2020-03-08 02:30:00"</code>, you
couldn't convert that straight into a zoned-time with this time zone. To
resolve these issues, the <code>nonexistent</code> argument can be used to specify
one of many nonexistent time resolution strategies.</p>
<p><em>Ambiguous</em> times are the result of daylight saving time "fallbacks".
For example, in the America/New_York time zone, there was a daylight
saving time fallback 1 second after <code>"2020-11-01 01:59:59 EDT"</code>, at which
point the clocks "fell backwards" by 1 hour, resulting in a printed time of
<code>"2020-11-01 01:00:00 EST"</code> (note the EDT-&gt;EST shift). This resulted in two
1 o'clock hours for this day, so if you had a naive time of
<code>"2020-11-01 01:30:00"</code>, you wouldn't be able to convert that directly
into a zoned-time with this time zone, as there is no way for clock to know
which of the two ambiguous times you wanted. To resolve these issues,
the <code>ambiguous</code> argument can be used to specify one of many ambiguous
time resolution strategies.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_naive_time.html">as_naive_time</a></span><span class="op">(</span><span class="fu"><a href="year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Converting a naive-time to a zoned-time generally retains the</span></span></span>
<span class="r-in"><span><span class="co"># printed time, while changing the underlying duration.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-01-01T00:00:00-05:00"</span>
<span class="r-in"><span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"America/Los_Angeles"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/Los_Angeles&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2019-01-01T00:00:00-08:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Nonexistent time:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">new_york</span> <span class="op">&lt;-</span> <span class="st">"America/New_York"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># There was a daylight saving gap in the America/New_York time zone on</span></span></span>
<span class="r-in"><span><span class="co"># 2020-03-08 01:59:59 -&gt; 03:00:00, which means that one of these</span></span></span>
<span class="r-in"><span><span class="co"># naive-times don't exist in that time zone. By default, attempting to</span></span></span>
<span class="r-in"><span><span class="co"># convert it to a zoned time will result in an error.</span></span></span>
<span class="r-in"><span><span class="va">nonexistent_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">03</span>, <span class="fl">08</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">02</span>, <span class="fl">03</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fl">00</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nonexistent_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_naive_time.html">as_naive_time</a></span><span class="op">(</span><span class="va">nonexistent_time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">nonexistent_time</span>, <span class="va">new_york</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in as_zoned_time(nonexistent_time, new_york) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Nonexistent time due to daylight saving time at location 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> Resolve nonexistent time issues by specifying the `nonexistent` argument.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Resolve this by specifying a nonexistent time resolution strategy</span></span></span>
<span class="r-in"><span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">nonexistent_time</span>, <span class="va">new_york</span>, nonexistent <span class="op">=</span> <span class="st">"roll-forward"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-03-08T03:00:00-04:00" "2020-03-08T03:30:00-04:00"</span>
<span class="r-in"><span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">nonexistent_time</span>, <span class="va">new_york</span>, nonexistent <span class="op">=</span> <span class="st">"roll-backward"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-03-08T01:59:59-05:00" "2020-03-08T03:30:00-04:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that rolling backwards will choose the last possible moment in</span></span></span>
<span class="r-in"><span><span class="co"># time at the current precision of the input</span></span></span>
<span class="r-in"><span><span class="va">nonexistent_nanotime</span> <span class="op">&lt;-</span> <span class="fu"><a href="time_point_cast.html">time_point_cast</a></span><span class="op">(</span><span class="va">nonexistent_time</span>, <span class="st">"nanosecond"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nonexistent_nanotime</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;naive_time&lt;nanosecond&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-03-08T02:45:00.000000000" "2020-03-08T03:30:00.000000000"</span>
<span class="r-in"><span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">nonexistent_nanotime</span>, <span class="va">new_york</span>, nonexistent <span class="op">=</span> <span class="st">"roll-backward"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;nanosecond&gt;&lt;America/New_York&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-03-08T01:59:59.999999999-05:00"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "2020-03-08T03:30:00.000000000-04:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A word of caution - Shifting does not guarantee that the relative ordering</span></span></span>
<span class="r-in"><span><span class="co"># of the input is maintained</span></span></span>
<span class="r-in"><span><span class="va">shifted</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">nonexistent_time</span>,</span></span>
<span class="r-in"><span>  <span class="va">new_york</span>,</span></span>
<span class="r-in"><span>  nonexistent <span class="op">=</span> <span class="st">"shift-forward"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">shifted</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-03-08T03:45:00-04:00" "2020-03-08T03:30:00-04:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 02:45:00 &lt; 03:30:00</span></span></span>
<span class="r-in"><span><span class="va">nonexistent_time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">nonexistent_time</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># 03:45:00 &gt; 03:30:00 (relative ordering is lost)</span></span></span>
<span class="r-in"><span><span class="va">shifted</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">shifted</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Ambiguous time:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">new_york</span> <span class="op">&lt;-</span> <span class="st">"America/New_York"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># There was a daylight saving time fallback in the America/New_York time</span></span></span>
<span class="r-in"><span><span class="co"># zone on 2020-11-01 01:59:59 EDT -&gt; 2020-11-01 01:00:00 EST, resulting</span></span></span>
<span class="r-in"><span><span class="co"># in two 1 o'clock hours. This means that the following naive time is</span></span></span>
<span class="r-in"><span><span class="co"># ambiguous since we don't know which of the two 1 o'clocks it belongs to.</span></span></span>
<span class="r-in"><span><span class="co"># By default, attempting to convert it to a zoned time will result in an</span></span></span>
<span class="r-in"><span><span class="co"># error.</span></span></span>
<span class="r-in"><span><span class="va">ambiguous_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">11</span>, <span class="fl">01</span>, <span class="fl">01</span>, <span class="fl">30</span>, <span class="fl">00</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ambiguous_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_naive_time.html">as_naive_time</a></span><span class="op">(</span><span class="va">ambiguous_time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">ambiguous_time</span>, <span class="va">new_york</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in as_zoned_time(ambiguous_time, new_york) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ambiguous time due to daylight saving time at location 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> Resolve ambiguous time issues by specifying the `ambiguous` argument.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Resolve this by specifying an ambiguous time resolution strategy</span></span></span>
<span class="r-in"><span><span class="va">earliest</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">ambiguous_time</span>, <span class="va">new_york</span>, ambiguous <span class="op">=</span> <span class="st">"earliest"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">latest</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">ambiguous_time</span>, <span class="va">new_york</span>, ambiguous <span class="op">=</span> <span class="st">"latest"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">na</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">ambiguous_time</span>, <span class="va">new_york</span>, ambiguous <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">earliest</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:30:00-04:00"</span>
<span class="r-in"><span><span class="va">latest</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:30:00-05:00"</span>
<span class="r-in"><span><span class="va">na</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now assume that you were given the following zoned-times, i.e.,</span></span></span>
<span class="r-in"><span><span class="co"># you didn't build them from scratch so you already know their otherwise</span></span></span>
<span class="r-in"><span><span class="co"># ambiguous offsets</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">earliest</span>, <span class="va">latest</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:30:00-04:00" "2020-11-01T01:30:00-05:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To set the seconds to 5 in both, you might try:</span></span></span>
<span class="r-in"><span><span class="va">x_naive</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_naive_time.html">as_naive_time</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_year_month_day.html">as_year_month_day</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="clock-setters.html">set_second</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_naive_time.html">as_naive_time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x_naive</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;naive_time&lt;second&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:30:05" "2020-11-01T01:30:05"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But this fails because you've "lost" the information about which</span></span></span>
<span class="r-in"><span><span class="co"># offsets these ambiguous times started in</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">x_naive</span>, <span class="fu"><a href="zoned-zone.html">zoned_time_zone</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in as_zoned_time(x_naive, zoned_time_zone(x)) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ambiguous time due to daylight saving time at location 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> Resolve ambiguous time issues by specifying the `ambiguous` argument.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To get around this, you can use that information by specifying</span></span></span>
<span class="r-in"><span><span class="co"># `ambiguous = x`, which will use the offset from `x` to resolve the</span></span></span>
<span class="r-in"><span><span class="co"># ambiguity in `x_naive` as long as `x` is also an ambiguous time with the</span></span></span>
<span class="r-in"><span><span class="co"># same daylight saving time transition point as `x_naive` (i.e. here</span></span></span>
<span class="r-in"><span><span class="co"># everything has a transition point of `"2020-11-01 01:00:00 EST"`).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">x_naive</span>, <span class="fu"><a href="zoned-zone.html">zoned_time_zone</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, ambiguous <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:30:05-04:00" "2020-11-01T01:30:05-05:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Say you added one more time to `x` that would not be considered ambiguous</span></span></span>
<span class="r-in"><span><span class="co"># in naive-time</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="fu"><a href="as_sys_time.html">as_sys_time</a></span><span class="op">(</span><span class="va">latest</span><span class="op">)</span> <span class="op">+</span> <span class="fl">3600</span>, <span class="fu"><a href="zoned-zone.html">zoned_time_zone</a></span><span class="op">(</span><span class="va">latest</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[3]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:30:00-04:00" "2020-11-01T01:30:00-05:00"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "2020-11-01T02:30:00-05:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Imagine you want to floor this vector to a multiple of 2 hours, with</span></span></span>
<span class="r-in"><span><span class="co"># an origin of 1am that day. You can do this by subtracting the origin,</span></span></span>
<span class="r-in"><span><span class="co"># flooring, then adding it back</span></span></span>
<span class="r-in"><span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="year_month_day.html">year_month_day</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">11</span>, <span class="fl">01</span>, <span class="fl">01</span>, <span class="fl">00</span>, <span class="fl">00</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_naive_time.html">as_naive_time</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_duration.html">as_duration</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x_naive</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_naive_time.html">as_naive_time</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="clock-arithmetic.html">add_seconds</a></span><span class="op">(</span><span class="op">-</span><span class="va">origin</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="time-point-rounding.html">time_point_floor</a></span><span class="op">(</span><span class="st">"hour"</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="clock-arithmetic.html">add_seconds</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x_naive</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;naive_time&lt;second&gt;[3]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:00:00" "2020-11-01T01:00:00" "2020-11-01T01:00:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You again have ambiguous naive-time points, so you might try using</span></span></span>
<span class="r-in"><span><span class="co"># `ambiguous = x`. It looks like this took care of the first two problems,</span></span></span>
<span class="r-in"><span><span class="co"># but we have an issue at location 3.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">x_naive</span>, <span class="fu"><a href="zoned-zone.html">zoned_time_zone</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, ambiguous <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in as_zoned_time(x_naive, zoned_time_zone(x), ambiguous = x) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ambiguous time due to daylight saving time at location 3.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> Resolve ambiguous time issues by specifying the `ambiguous` argument.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When we floored from 02:30:00 -&gt; 01:00:00, we went from being</span></span></span>
<span class="r-in"><span><span class="co"># unambiguous -&gt; ambiguous. In clock, this is something you must handle</span></span></span>
<span class="r-in"><span><span class="co"># explicitly, and cannot be handled by using information from `x`. You can</span></span></span>
<span class="r-in"><span><span class="co"># handle this while still retaining the behavior for the other two</span></span></span>
<span class="r-in"><span><span class="co"># time points that were ambiguous before and after the floor by passing a</span></span></span>
<span class="r-in"><span><span class="co"># list containing `x` and an ambiguous time resolution strategy to use</span></span></span>
<span class="r-in"><span><span class="co"># when information from `x` can't resolve ambiguities:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="as_zoned_time.html">as_zoned_time</a></span><span class="op">(</span><span class="va">x_naive</span>, <span class="fu"><a href="zoned-zone.html">zoned_time_zone</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, ambiguous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"latest"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;zoned_time&lt;second&gt;&lt;America/New_York&gt;[3]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-11-01T01:00:00-04:00" "2020-11-01T01:00:00-05:00"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "2020-11-01T01:00:00-05:00"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

