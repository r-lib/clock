<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Counting: date-times — posixt-count-between • clock</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Counting: date-times — posixt-count-between"><meta name="description" content='This is a POSIXct/POSIXlt method for the date_count_between() generic.
date_count_between() counts the number of precision units between
start and end (i.e., the number of years or months). This count
corresponds to the whole number of units, and will never return a
fractional value.
This is suitable for, say, computing the whole number of years or months
between two dates, accounting for the day of the month and the time of day.
Internally, the date-time is converted to one of the following three clock
types, and the counting is done directly on that type. The choice of type is
based on the most common interpretation of each precision, but is ultimately
a heuristic. See the examples for more information.
Calendrical based counting:
These precisions convert to a year-month-day calendar and count while in that
type.
"year"
"quarter"
"month"


Naive-time based counting:
These precisions convert to a naive-time and count while in that type.
"week"
"day"


Sys-time based counting:
These precisions convert to a sys-time and count while in that type.
"hour"
"minute"
"second"

'><meta property="og:description" content='This is a POSIXct/POSIXlt method for the date_count_between() generic.
date_count_between() counts the number of precision units between
start and end (i.e., the number of years or months). This count
corresponds to the whole number of units, and will never return a
fractional value.
This is suitable for, say, computing the whole number of years or months
between two dates, accounting for the day of the month and the time of day.
Internally, the date-time is converted to one of the following three clock
types, and the counting is done directly on that type. The choice of type is
based on the most common interpretation of each precision, but is ultimately
a heuristic. See the examples for more information.
Calendrical based counting:
These precisions convert to a year-month-day calendar and count while in that
type.
"year"
"quarter"
"month"


Naive-time based counting:
These precisions convert to a naive-time and count while in that type.
"week"
"day"


Sys-time based counting:
These precisions convert to a sys-time and count while in that type.
"hour"
"minute"
"second"

'><meta property="og:image" content="https://clock.r-lib.org/logo.png"><meta name="robots" content="noindex"><script src="https://cdn.jsdelivr.net/gh/posit-dev/supported-by-posit/js/badge.min.js" data-max-height="43" data-light-bg="#666f76" data-light-fg="#f9f9f9"></script><script defer data-domain="clock.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clock</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/clock.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/faq.html">Frequently Asked Questions</a></li>
    <li><a class="dropdown-item" href="../articles/motivations.html">Motivations for clock</a></li>
    <li><a class="dropdown-item" href="../articles/recipes.html">Examples and Recipes</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/03/clock-0-1-0/">Version 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/clock/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Counting: date-times</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/clock/blob/main/R/posixt.R" class="external-link"><code>R/posixt.R</code></a></small>
      <div class="d-none name"><code>posixt-count-between.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a POSIXct/POSIXlt method for the <code><a href="date_count_between.html">date_count_between()</a></code> generic.</p>
<p><code><a href="date_count_between.html">date_count_between()</a></code> counts the number of <code>precision</code> units between
<code>start</code> and <code>end</code> (i.e., the number of years or months). This count
corresponds to the <em>whole number</em> of units, and will never return a
fractional value.</p>
<p>This is suitable for, say, computing the whole number of years or months
between two dates, accounting for the day of the month and the time of day.</p>
<p>Internally, the date-time is converted to one of the following three clock
types, and the counting is done directly on that type. The choice of type is
based on the most common interpretation of each precision, but is ultimately
a heuristic. See the examples for more information.</p>
<p><em>Calendrical based counting:</em></p>
<p>These precisions convert to a year-month-day calendar and count while in that
type.</p><ul><li><p><code>"year"</code></p></li>
<li><p><code>"quarter"</code></p></li>
<li><p><code>"month"</code></p></li>
</ul><p><em>Naive-time based counting:</em></p>
<p>These precisions convert to a naive-time and count while in that type.</p><ul><li><p><code>"week"</code></p></li>
<li><p><code>"day"</code></p></li>
</ul><p><em>Sys-time based counting:</em></p>
<p>These precisions convert to a sys-time and count while in that type.</p><ul><li><p><code>"hour"</code></p></li>
<li><p><code>"minute"</code></p></li>
<li><p><code>"second"</code></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'POSIXt'</span></span>
<span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span>, <span class="va">precision</span>, <span class="va">...</span>, n <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-start-end">start, end<a class="anchor" aria-label="anchor" href="#arg-start-end"></a></dt>
<dd><p><code>[POSIXct / POSIXlt]</code></p>
<p>A pair of date-time vectors. These will be recycled to their common
size.</p></dd>


<dt id="arg-precision">precision<a class="anchor" aria-label="anchor" href="#arg-precision"></a></dt>
<dd><p><code>[character(1)]</code></p>
<p>One of:</p><ul><li><p><code>"year"</code></p></li>
<li><p><code>"quarter"</code></p></li>
<li><p><code>"month"</code></p></li>
<li><p><code>"week"</code></p></li>
<li><p><code>"day"</code></p></li>
<li><p><code>"hour"</code></p></li>
<li><p><code>"minute"</code></p></li>
<li><p><code>"second"</code></p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p><code>[positive integer(1)]</code></p>
<p>A single positive integer specifying a multiple of <code>precision</code> to use.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An integer representing the number of <code>precision</code> units between
<code>start</code> and <code>end</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>"quarter"</code> is equivalent to <code>"month"</code> precision with <code>n</code> set to <code>n * 3L</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="comparison-direction">Comparison Direction<a class="anchor" aria-label="anchor" href="#comparison-direction"></a></h2>


<p>The computed count has the property that if <code>start &lt;= end</code>, then
<code>start + &lt;count&gt; &lt;= end</code>. Similarly, if <code>start &gt;= end</code>, then
<code>start + &lt;count&gt; &gt;= end</code>. In other words, the comparison direction between
<code>start</code> and <code>end</code> will never change after adding the count to <code>start</code>. This
makes this function useful for repeated count computations at
increasingly fine precisions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="date-time-parse.html">date_time_parse</a></span><span class="op">(</span><span class="st">"2000-05-05 02:00:00"</span>, zone <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="date-time-parse.html">date_time_parse</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2020-05-05 01:00:00"</span>, <span class="st">"2020-05-05 03:00:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  zone <span class="op">=</span> <span class="st">"America/New_York"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Age in years</span></span></span>
<span class="r-in"><span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span>, <span class="st">"year"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Number of "whole" months between these dates. i.e.</span></span></span>
<span class="r-in"><span><span class="co"># `2000-05-05 02:00:00 -&gt; 2020-04-05 02:00:00` is 239 months</span></span></span>
<span class="r-in"><span><span class="co"># `2000-05-05 02:00:00 -&gt; 2020-05-05 02:00:00` is 240 months</span></span></span>
<span class="r-in"><span><span class="co"># Since `2020-05-05 01:00:00` occurs before the 2nd hour,</span></span></span>
<span class="r-in"><span><span class="co"># it gets a count of 239</span></span></span>
<span class="r-in"><span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span>, <span class="st">"month"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 239 240</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Number of seconds between</span></span></span>
<span class="r-in"><span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span>, <span class="st">"second"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 631148400 631155600</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Naive-time VS Sys-time interpretation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The difference between whether `start` and `end` are converted to a</span></span></span>
<span class="r-in"><span><span class="co"># naive-time vs a sys-time comes into play when dealing with daylight</span></span></span>
<span class="r-in"><span><span class="co"># savings.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Here are two times around a 1 hour DST gap where clocks jumped from</span></span></span>
<span class="r-in"><span><span class="co"># 01:59:59 -&gt; 03:00:00</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="date_time_build.html">date_time_build</a></span><span class="op">(</span><span class="fl">1970</span>, <span class="fl">4</span>, <span class="fl">26</span>, <span class="fl">1</span>, <span class="fl">50</span>, <span class="fl">00</span>, zone <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="date_time_build.html">date_time_build</a></span><span class="op">(</span><span class="fl">1970</span>, <span class="fl">4</span>, <span class="fl">26</span>, <span class="fl">3</span>, <span class="fl">00</span>, <span class="fl">00</span>, zone <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When treated like sys-times, these are considered to be 10 minutes apart,</span></span></span>
<span class="r-in"><span><span class="co"># which is the amount of time that would have elapsed if you were watching</span></span></span>
<span class="r-in"><span><span class="co"># a clock as it changed between these two times.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="st">"minute"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Lets add a 3rd date that is ~1 day ahead of these</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="date_time_build.html">date_time_build</a></span><span class="op">(</span><span class="fl">1970</span>, <span class="fl">4</span>, <span class="fl">27</span>, <span class="fl">1</span>, <span class="fl">55</span>, <span class="fl">00</span>, zone <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When treated like naive-times, `z` is considered to be at least 1 day ahead</span></span></span>
<span class="r-in"><span><span class="co"># of `x`, because `01:55:00` is after `01:50:00`. This is probably what you</span></span></span>
<span class="r-in"><span><span class="co"># expected.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span>, <span class="st">"day"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If these were interpreted like sys-times, then `z` would not be considered</span></span></span>
<span class="r-in"><span><span class="co"># to be 1 day ahead. That would look something like this:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span>, <span class="st">"second"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 83100</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">trunc</a></span><span class="op">(</span><span class="fu"><a href="date_count_between.html">date_count_between</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span>, <span class="st">"second"</span><span class="op">)</span> <span class="op">/</span> <span class="fl">86400</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This is because there have only been 83,100 elapsed seconds since `x`,</span></span></span>
<span class="r-in"><span><span class="co"># which isn't a full day's worth (86,400 seconds). But we'd generally</span></span></span>
<span class="r-in"><span><span class="co"># consider `z` to be 1 day ahead of `x` (and ignore the DST gap), so that is</span></span></span>
<span class="r-in"><span><span class="co"># how it is implemented.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can override this by converting directly to sys-time, then using</span></span></span>
<span class="r-in"><span><span class="co"># `time_point_count_between()`</span></span></span>
<span class="r-in"><span><span class="va">x_st</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_sys_time.html">as_sys_time</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_st</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;sys_time&lt;second&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1970-04-26T06:50:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">z_st</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_sys_time.html">as_sys_time</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z_st</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;sys_time&lt;second&gt;[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1970-04-27T05:55:00"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="time_point_count_between.html">time_point_count_between</a></span><span class="op">(</span><span class="va">x_st</span>, <span class="va">z_st</span>, <span class="st">"day"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

  </div></footer></body></html>

